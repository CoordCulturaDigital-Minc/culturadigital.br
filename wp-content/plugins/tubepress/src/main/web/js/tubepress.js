var TubePress=(function(e,d){var m="tubepress",k="urls",c="base",f="sys",h="js",n=d.location,l=d.document,p=true,o="src/main/web/js",q=e.isFunction,g=d.TubePressJsConfig,a=(function(){var x=function(C){return typeof C!=="undefined"},z=function(D){D=D.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var C="[\\?&]"+D+"=([^&#]*)",F=new RegExp(C),E=F.exec(n.search);return E===null?"":decodeURIComponent(E[1].replace(/\+/g," "))},y=function(C){var D=parseInt(C,10);return isNaN(D)?0:D},w=function(F,E,C){if(E()===p){F();return}var D=function(){w(F,E,C)};setTimeout(D,C)},B=function(F){if(!F){return false}var C=Array.prototype.slice.call(arguments),E=C.shift(),D;for(D=0;D<C.length;D+=1){if(!E.hasOwnProperty(C[D])){return false}E=E[C[D]]}return true},A=function(C,D){if(D){return C.replace(/^\/+/,"")}return C.replace(/\/+$/,"")};return{isDefined:x,getParameterByName:z,parseIntOrZero:y,callWhenTrue:w,hasOwnNestedProperty:B,trimSlashes:A}}()),v=(function(){var y=n.search.indexOf(m+"_debug=true")!==-1,B=d.console,w=a.isDefined(B),x=function(){return y&&w},A=function(C){B.log(C)},z=function(C){B.dir(C)};return{on:x,log:A,dir:z}}()),s=(function(){var x=false,w,z=function(){if(!x){if(a.hasOwnNestedProperty(g,k,c)){w=a.trimSlashes(g[k][c],false)}else{var B=l.getElementsByTagName("script"),A=0,C;for(A;A<B.length;A+=1){C=B[A].src;if(C.indexOf("/"+m+".js")!==-1){w=a.trimSlashes(C.substr(0,C.lastIndexOf("/")).split("?")[0].replace(o,""),false);break}}}}return w},y=function(){var A="ajaxEndpoint",B="php";if(a.hasOwnNestedProperty(g,k,B,f,A)){return g[k][B][f][A]}return z()+"/src/main/web/php/"+A+".php"};return{getBaseUrl:z,getAjaxEndpointUrl:y}}()),u=(function(){var x=e({}),w=function(){x.bind.apply(x,arguments)},z=function(){x.unbind.apply(x,arguments)},y=function(){if(v.on()){var A=arguments;v.log('Firing "'+A[0]);v.dir(A[1])}x.trigger.apply(x,arguments)};return{subscribe:w,unsubscribe:z,publish:y}}()),i=(function(){var B=[],z=function(H){return B[H]===p},w=function(H){if(H.indexOf("http")===0){return H}return s.getBaseUrl()+"/"+a.trimSlashes(H,true)},F=function(I,H){if(v.on()){v.log("Injecting "+H+": "+I)}},G=function(H){l.getElementsByTagName("head")[0].appendChild(H)},E=function(I){I=w(I);if(z(I)){return}B[I]=p;var H=l.createElement("link");H.rel="stylesheet";H.type="text/css";H.href=I;F(I,"CSS");G(H)},x=function(I){I=w(I);if(z(I)){return}B[I]=p;F(I,"JS");var H=l.createElement("script");H.type="text/javascript";H.src=I;H.async=p;l.getElementsByTagName("head")[0].appendChild(H)},y=function(H){if(a.hasOwnNestedProperty(g,k,h,f,H)){x(g[k][h][f][H])}else{x(o+"/"+H+".js")}},D=function(){y("gallery")},C=function(){y("playerApi")},A=function(){y("ajaxSearch")};return{loadJs:x,loadCss:E,loadGalleryJs:D,loadPlayerApiJs:C,loadAjaxSearchJs:A}}()),r=(function(){var w=function(z,A){var y=v.on(),C,x=d[z],B=function(D){var F=D[0],E=D.slice(1);A[F].apply(this,E)};if(a.isDefined(x)){C=x.length;if(y){v.log("Running "+C+" queue items for "+z)}x.reverse();while(x.length){B(x.pop())}}if(y){v.log(z+" is now connected")}d[z]={push:B}};return{processQueueCalls:w}}()),j=(function(){var w=e.fn.jquery,z=/1\.6|7|8|9\.[0-9]+/.test(w)!==false,y,x=function(A){return y(A)};if(z){y=function(A){return e.parseJSON(A)}}else{y=function(A){if(typeof A!=="string"||!A){return null}A=e.trim(A);if(/^[\],:{}\s]*$/.test(A.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return(d.JSON&&d.JSON.parse)?d.JSON.parse(A):(new Function("return "+A))()}else{throw"Invalid JSON: "+A}}}return{parse:x}}()),t=(function(){var x=function(y){e(y).fadeTo(0,0.3)},w=function(y){e(y).fadeTo(0,1)};return{applyLoadingStyle:x,removeLoadingStyle:w}}()),b=(function(){var y=function(H,B,E,A,D,G){var C=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,F=function(J){var K=J.responseText,I=A?e("<div>").append(K.replace(C,"")).find(A):K;e(E).html(I);if(q(G)){G()}};if(q(D)){D()}e.ajax({url:B,type:H,dataType:"html",complete:F})},x=function(E,B,C,D,A){e.ajax({url:B,type:E,data:C,dataType:A,complete:D})},z=function(A){t.removeLoadingStyle(A)},w=function(G,B,E,A,D,F){var C=function(){z(E)};t.applyLoadingStyle(E);if(q(F)){C=function(){z(E);F()}}y(G,B,E,A,D,C)};return{loadAndStyle:w,get:x}}());(function(){var w="tubePress";r.processQueueCalls(w+"DomInjector",i);r.processQueueCalls(w+"Beacon",u)}());return{Ajax:{Executor:b,LoadStyler:t},AsyncUtil:r,Beacon:u,DomInjector:i,Environment:s,Lang:{Utils:a,JsonParser:j},Logger:v}}(jQuery,window));