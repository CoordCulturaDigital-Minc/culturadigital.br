See the datamapper unit tests for details about the API